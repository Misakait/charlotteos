	# ä¸ºæ¯ä¸ªæ ¸å¿ƒçš„æ ˆå®šä¹‰å¤§å°ï¼Œè¿™é‡Œæ˜¯ 16KB
	.equ	STACK_SIZE, 1024*16

	# å°† _start ç¬¦å·å£°æ˜ä¸ºå…¨å±€å¯è§ï¼Œä½œä¸ºç¨‹åºå…¥å£
	.global	_start

	# .text
	.section .text.entry
_start:
	# park harts with id != 0
	# è®©é 0 å·æ ¸å¿ƒâ€œå¾…å‘½â€

	csrr	t0, mhartid		# è¯» CSR å¯„å­˜å™¨ mhartidï¼Œè·å–å½“å‰æ ¸å¿ƒçš„IDï¼Œå­˜å…¥ t0 å¯„å­˜å™¨
	mv	tp, t0			# å°†æ ¸å¿ƒIDä» t0 ç§»åˆ° tp å¯„å­˜å™¨ä¸­å¤‡ä»½ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨
	bnez	t0, park		# bnez (Branch if Not Equal to Zero): å¦‚æœ t0 ä¸ä¸ºé›¶ï¼ˆå³æ ¸å¿ƒIDä¸æ˜¯0ï¼‰ï¼Œåˆ™è·³è½¬åˆ° park æ ‡ç­¾

	# Setup stacks, the stack grows from bottom to top, so we put the
	# stack pointer to the very end of the stack range.
	# (æ³¨é‡Šæœ‰è¯¯ï¼ŒRISC-V æ ˆé€šå¸¸æ˜¯å‘ä¸‹ç”Ÿé•¿çš„ï¼Œä½†è¿™é‡Œçš„è®¡ç®—é€»è¾‘æ˜¯æ­£ç¡®çš„)
	# ä¸º 0 å·æ ¸å¿ƒè®¾ç½®æ ˆ

	slli	t0, t0, 14		# slli (Shift Left Logical Immediate): å°† t0 (æ­¤æ—¶å¿…ä¸º0) å·¦ç§» 14 ä½ã€‚
					# 1^14 = 16384ï¼Œæ‰€ä»¥è¿™è¡Œç›¸å½“äº t0 = t0 * STACK_SIZEã€‚å¯¹äº0å·æ ¸å¿ƒï¼Œt0 ä»ç„¶æ˜¯ 0ã€‚
	la	sp, stacks + STACK_SIZE	# la (Load Address): å°† `stacks` æ ‡ç­¾çš„åœ°å€åŠ ä¸Šä¸€ä¸ªæ ˆçš„å¤§å°(STACK_SIZE)ï¼Œç»“æœåŠ è½½åˆ° sp (æ ˆæŒ‡é’ˆ)ã€‚
					# è¿™å°† sp æŒ‡å‘äº†ç¬¬ä¸€ä¸ªæ ˆç©ºé—´çš„æœ«å°¾ï¼ˆé«˜åœ°å€å¤„ï¼‰ã€‚
	add	sp, sp, t0		# å°† sp å’Œ t0 ç›¸åŠ ã€‚å¯¹äº0å·æ ¸å¿ƒï¼Œt0æ˜¯0ï¼Œæ‰€ä»¥ sp ä¸å˜ã€‚
					# (å¯¹äºå…¶ä»–æ ¸å¿ƒï¼Œè¿™è¡Œä»£ç ä¼šå°† sp æŒ‡å‘å±äºå®ƒä»¬è‡ªå·±çš„æ ˆç©ºé—´)

	j rust_main
park:
	wfi				# wfi (Wait For Interrupt): è®©CPUæ ¸å¿ƒè¿›å…¥ä½åŠŸè€—ç¡çœ çŠ¶æ€ï¼Œç›´åˆ°è¢«ä¸­æ–­å”¤é†’ã€‚
	j	park			# é 0 å·æ ¸å¿ƒåœ¨è¿™é‡Œæ— é™å¾ªç¯ç­‰å¾…ï¼Œè¿›å…¥â€œå¾…å‘½â€çŠ¶æ€ ğŸ˜´

	# In the standard RISC-V calling convention, the stack pointer sp
	# is always 16-byte aligned.
	# ç¡®ä¿ä¸‹é¢çš„ `stacks` æ ‡ç­¾åœ°å€æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œèƒ½æå‡æ€§èƒ½ã€‚
.balign 16
stacks:
	# .skip æŒ‡ä»¤ï¼šåœ¨è¿™é‡Œé¢„ç•™ä¸€å—å†…å­˜ç©ºé—´
	# STACK_SIZE * 1: é¢„ç•™ 1 ä¸ªæ ¸å¿ƒçš„æ ˆç©ºé—´
	# è¿™å—å†…å­˜å°±æ˜¯æ‰€æœ‰æ ¸å¿ƒçš„æ ˆçš„æ€»å’Œã€‚
	.skip	STACK_SIZE * 1

	.end				# æ–‡ä»¶ç»“æŸ
